<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.15"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>Radar Host Communication library: Radar Communication library</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
  $(document).ready(initResizable);
/* @license-end */</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">Radar Host Communication library
   &#160;<span id="projectnumber">1.2.2</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.15 -->
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
var searchBox = new SearchBox("searchBox", "search",false,'Search');
/* @license-end */
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
/* @license-end */</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:cf05388f2679ee054f2beb29a391d25f4e673ac3&amp;dn=gpl-2.0.txt GPL-v2 */
$(document).ready(function(){initNavTree('index.html','');});
/* @license-end */
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="PageDoc"><div class="header">
  <div class="headertitle">
<div class="title">Radar Communication library </div>  </div>
</div><!--header-->
<div class="contents">
<div class="textblock"><h1><a class="anchor" id="intro_sec"></a>
Introduction</h1>
<p>The communication protocol is a generic protocol to exchange messages with microcontroller based devices over a generic byte stream connection (typically a virtual serial port over USB). The communication is always initiated by the host, while the connected microcontroller device responds to messages received from the host.</p>
<p>The protocol defines two types of messages, payload messages and status messages. A payload message contains a block of data with arbitrary size and meaning. A status message contains a 16 bit status code. Messages from the host to the device are always payload messages. Whenever the device receives a payload message from the host, it responds with one (and only one) status message. The device may also send an arbitrary number of additional payload messages preceding that status message. Once the device has sent the status message, it won't send any more messages until it receives a new message from the host.</p>
<p>Each message from the host to the device is addressed to a certain logical endpoint and each message from the device to the host is sent from a logical endpoint. The number of logical endpoints is defined by the device. Endpoints are continuously enumerated starting with 1. At least one logical endpoint is always present. Endpoints are used to define functional groups in the device.</p>
<p>Each logical endpoint is of a defined type, which defines the meaning of the message payload exchanged with that endpoint. Additionally each endpoint has a version number that allows to distinguish between slight modifications of the endpoints set of known messages. The host can query type and version of the endpoints present in the device.</p>
<p>All data received from the connected device is returned through callbacks. For each message type that can be received from the device, a separate callback function type is defined.</p>
<p>The user must register the callback function for each message type. If no callback function is registered the received message is ignored. Additionally the user can provide a data context pointer for each callback function that will be forwarded with any call to that function.</p>
<p>Example for Endpoint enumeration.</p>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;stdint.h&gt;</span></div><div class="line"></div><div class="line"><span class="keywordtype">int</span> main (<span class="keywordtype">int</span> argc, <span class="keywordtype">char</span> *argv[])</div><div class="line">{</div><div class="line">  <span class="keywordtype">char</span> pComPortName[] = <span class="stringliteral">&quot;COM5&quot;</span>; <span class="comment">/* insert true COM port name here */</span></div><div class="line">  int32_t iProtocolHandle;</div><div class="line">  uint8_t uEndpointRadarBase = 0;</div><div class="line">  </div><div class="line">  iProtocolHandle = <a class="code" href="_protocol_8h.html#a9f43c7e3d4ce0fd097a22574238b2f7f">protocol_connect</a>(pComPortName);</div><div class="line">  </div><div class="line">  <span class="keywordflow">if</span> (iProtocolHandle &lt; 0)</div><div class="line">  {</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">       An error has occurred. The error can be handled here.</span></div><div class="line"><span class="comment">       In this example the error code is used as exit code.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">    <span class="keywordflow">return</span> iProtocolHandle;</div><div class="line">  }</div><div class="line"></div><div class="line">  <span class="comment">/* Check all endpoints for the searched Radar Base endpoint */</span>  </div><div class="line">  <span class="keywordflow">for</span> (uint8_t i = 1; i &lt;= <a class="code" href="_protocol_8h.html#ad0b74eaf568e59087311055790131c1c">protocol_get_num_endpoints</a>(iProtocolHandle); ++i)</div><div class="line">  {</div><div class="line">    <span class="keywordtype">int</span> iCompatibility;</div><div class="line"></div><div class="line">    <span class="comment">/* use the appropriate endpoint function to check compatibility */</span></div><div class="line">    iCompatibility = <a class="code" href="group___endpoint_radar_base.html#gaeec40a9d842c83fe75b027c736f1b42a">ep_radar_base_is_compatible_endpoint</a>(iProtocolHandle, i);</div><div class="line">                </div><div class="line">    <span class="keywordflow">if</span> (iCompatibility == <a class="code" href="group___error_codes.html#ga65aec3d39a88a2aa98ff0fc58a95daf3">PROTOCOL_ERROR_ENDPOINT_VERSION_TOO_OLD</a>)</div><div class="line">    {</div><div class="line">      <span class="comment">/*</span></div><div class="line"><span class="comment">         The current endpoint is not compatible</span></div><div class="line"><span class="comment">         --------------------------------------</span></div><div class="line"><span class="comment">         The endpoint implementation in the library is newer than the endpoint implementation</span></div><div class="line"><span class="comment">         in the connected device.</span></div><div class="line"><span class="comment">         A firmware update of the device is recommended.</span></div><div class="line"><span class="comment">       */</span></div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iCompatibility == <a class="code" href="group___error_codes.html#gaf2a68031910a78b0621d66ef118e961f">PROTOCOL_ERROR_ENDPOINT_VERSION_TOO_NEW</a>)</div><div class="line">    {</div><div class="line">      <span class="comment">/*</span></div><div class="line"><span class="comment">         The current endpoint is not compatible</span></div><div class="line"><span class="comment">         --------------------------------------</span></div><div class="line"><span class="comment">         The endpoint implementation in the library is older than the endpoint implementation</span></div><div class="line"><span class="comment">         in the connected device.</span></div><div class="line"><span class="comment">         A library update is recommended.</span></div><div class="line"><span class="comment">       */</span></div><div class="line">    }</div><div class="line">    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (iCompatibility == 0)</div><div class="line">    {</div><div class="line">      <span class="comment">/*</span></div><div class="line"><span class="comment">         The current endpoint is a compatible radar base endpoint,</span></div><div class="line"><span class="comment">         so remember the endpoint number and continue with next endpoint.</span></div><div class="line"><span class="comment">       */</span></div><div class="line">      uEndpointRadarBase = i;</div><div class="line">      <span class="keywordflow">continue</span>;</div><div class="line">    }</div><div class="line">  </div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">       For each required endpoint type the code above can be repeated to find the endpoint numbers.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">  }</div><div class="line">  </div><div class="line">  <span class="keywordflow">if</span> (uEndpointRadarBase == 0)</div><div class="line">  {</div><div class="line">    <span class="comment">/*</span></div><div class="line"><span class="comment">       The connected device does not contain an endpoint of type radar base. There is nothing left to do</span></div><div class="line"><span class="comment">       but closing the connection and quit the application.</span></div><div class="line"><span class="comment">     */</span></div><div class="line">     <a class="code" href="_protocol_8h.html#a043e4544ef7d3a9ba12d186f7f7e7e60">protocol_disconnect</a>(iProtocolHandle);</div><div class="line">     <span class="keywordflow">return</span> -1;</div><div class="line">  }</div><div class="line">  </div><div class="line">  <span class="comment">/*</span></div><div class="line"><span class="comment">     Now the protocol can be used. iProtocolHandle and uEndpointRadarBase must be forwarded to all</span></div><div class="line"><span class="comment">     function calls of EndpointRadarBase.</span></div><div class="line"><span class="comment">   */</span></div><div class="line"></div><div class="line">  <span class="comment">/* ... */</span></div><div class="line">  </div><div class="line">  <span class="comment">/* Finally close the connection before quitting the application */</span></div><div class="line">  <a class="code" href="_protocol_8h.html#a043e4544ef7d3a9ba12d186f7f7e7e60">protocol_disconnect</a>(iProtocolHandle);</div><div class="line"></div><div class="line">  <span class="keywordflow">return</span> 0;</div><div class="line">}</div></div><!-- fragment --> </div></div><!-- PageDoc -->
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.15 </li>
  </ul>
</div>
</body>
</html>
